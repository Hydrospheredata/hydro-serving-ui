import {decodeTsRecord, asServingReqRes} from './reqstore_format';

describe('Yoyoyo', () => {

  const data = 
    `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
bGF0ZW5jeRIHCAkSAFIBBQ==`

  it('zzzz', () => {
    const bytes = decodeBase64(data);
    const wtf = decodeTsRecord(bytes);

    const descrR = [];
    wtf.forEach(function(v) {
      const descrE = [];
      v.entries.forEach(function(x) {
        const reqRes = asServingReqRes(x.data);
        const reqS = JSON.stringify(reqRes.req.toJSON());
        const respS = JSON.stringify(reqRes.resp.toJSON());

        descrE.push(`\tEntry:${x.uid}`);
        descrE.push(`\t\tReq:${reqS}`);
        descrE.push(`\t\tResp:${respS}`);

      });
      const joined = descrE.join('\n');
      descrR.push(`Record:${v.ts}\n${joined}`);
    });
    const finalDescr = descrR.join('\n');
    console.log(finalDescr);
  });
});

function decodeBase64(input: string): Uint8Array {
  const raw = window.atob(input);

  const rawLength = raw.length;

  const array = new Uint8Array(new ArrayBuffer(rawLength));

  for (let i = 0; i < rawLength; i++) {
    array[i] = raw.charCodeAt(i);
  }
  return array;
}
